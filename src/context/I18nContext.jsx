import React, { createContext, useContext, useMemo, useState, useEffect } from 'react';

const I18nContext = createContext({ t: (k) => k, lang: 'en', setLang: () => {} });

const DICT = {
  en: {
    'brand.name': 'Dumps Master',
    'nav.dashboard': 'Dashboard',
    'nav.history': 'History',
    'nav.groups': 'Groups',
    'nav.admin': 'Admin',
    'nav.profile': 'Profile',
    'nav.logout': 'Logout',
    'nav.toggleTheme': 'Toggle Theme',
    'footer.built': 'Built for learning.',

    'auth.login': 'Login',
    'auth.signup': 'Sign Up',
    'auth.email': 'Email',
    'auth.password': 'Password',
    'auth.confirmPassword': 'Confirm Password',
    "auth.togglePrefix.login": "Don't have an account? ",
    'auth.toggleLink.login': 'Sign Up',
    'auth.togglePrefix.signup': 'Already have an account? ',
    'auth.toggleLink.signup': 'Login',

    'dashboard.loading': 'Loading dumps...',
    'dashboard.empty': 'No dumps found',
    'hero.badge': 'Exam Practice Platform',
    'hero.title': 'Your Exam Practice Hub',
    'hero.subtitle': 'Practice with exam dumps, upload your own questions, and explore the public library. Master your certification exams with interactive quizzes.',
    'tour.title': 'Welcome to Dumps Master! üéì',
    'tour.howto': 'How to Use This App:',
    'tour.step1.title': 'Download Sample File',
    'tour.step1.desc': 'Download our sample dumps file to see the correct format.',
    'tour.step1.cta': 'Download Sample File',
    'tour.step2.title': 'Edit Your Dumps',
    'tour.step2.desc': 'Open the CSV file in Excel or Google Sheets. Add your own questions following the same format:',
    'tour.step2.listA': 'Column A: Question text',
    'tour.step2.listB': 'Columns B-E: Answer options (A, B, C, D)',
    'tour.step2.listC': 'Column F: Correct answer (A, B, C, or D)',
    'tour.step3.title': 'Upload Your Dump',
    'tour.step3.desc': 'Click the "Add New" button below and upload your edited CSV file. You can set it as public or private.',
    'tour.step4.title': 'Start Practicing!',
    'tour.step4.desc': 'Click "View" on any dump to start taking the quiz. You can also explore the Public Library to practice with dumps shared by others.',
    'tour.close': "Got it, Let's Start!",
    'section.available': 'Available Exam Dumps',
    'tabs.my': 'My Dumps',
    'tabs.group': 'Group',
    'tabs.public': 'Public',
    'search.placeholder': 'Search dumps by name...',
    'filter.all': 'All Categories',
    'filter.uncategorized': 'Uncategorized',
    'button.addNew': 'Add New',
    'modal.quickUpload.title': 'Quick Upload',
    'card.selfPaced': 'Self-paced',
    'card.view': 'View',
    'tooltip.edit': 'Edit',
    'tooltip.delete': 'Delete',
    'empty.hint.search': "Try adjusting your search or filters to find what you're looking for.",
    'empty.hint.my': 'Get started by uploading your first exam dump using the "Add New" button above.',
    'empty.hint.public': 'No public dumps available yet. Check back later or create your own!',
    'empty.createFirst': 'Create Your First Dump',
    'common.cancel': 'Cancel',
    'common.saveChanges': 'Save Changes',
    'common.shareToGroups': 'Share to Groups',
    'common.export': 'Export',
    'common.import': 'Import',
    'common.name': 'Name',
    'common.description': 'Description',
    'editor.title': 'Edit Dump',
    'editor.questions': 'Questions',
    'editor.addQuestion': 'Add Question',
    'editor.editQuestion': 'Edit Question',
    'editor.correctAnswers': 'Correct Answers',
    'editor.settings': 'Settings',
    'editor.dumpName': 'Dump Name',
    'editor.enterDumpName': 'Enter dump name',
    'editor.visibility': 'Visibility',
    'editor.private': 'Private',
    'editor.public': 'Public',
    'editor.category': 'Category',
    'editor.quizMode': 'Quiz Mode',
    'editor.practice': 'Practice',
    'editor.exam': 'Exam',
    'editor.practiceHint': 'See correct answers immediately after each question.',
    'editor.examHint': 'Complete all questions first, then review at the end.',
    'editor.timeLimitMinutes': 'Time Limit (Minutes)',
    'editor.noLimitHint': 'Set to 0 for no limit',
    'editor.questionText': 'Question Text',
    'editor.optionLabel': 'Option {opt}',
    'editor.optionPlaceholder': 'Option {opt}',
    'editor.answerLabel': 'Answer',
    'editor.optionsCount': '{count} Options',
    'editor.deleteQuestion': 'Delete Question',
    'editor.emptyNoQuestions': 'No questions yet. Add one to get started!',
    'editor.updateQuestion': 'Update Question',
    'editor.filterGroups': 'Filter groups',
    'editor.selectedCount': '{count} selected',
    'editor.clearSelection': 'Clear selection',
    'editor.unshareAll': 'Unshare All',
    'editor.duplicates.title': 'Duplicate Questions Detected',
    'editor.duplicates.skip': 'Skip Duplicates',
    'editor.duplicates.replace': 'Replace Duplicates',
    'editor.duplicates.merge': 'Merge All',
    'editor.multipleCorrectHint': 'You can select multiple correct options',
    'editor.questionType': 'Question Type',
    'editor.types.multipleSingle': 'Multiple Choice (Single)',
    'editor.types.multipleMultiple': 'Multiple Choice (Multiple)',
    'editor.types.trueFalse': 'True / False',
    'editor.types.shortAnswer': 'Short Answer',
    'editor.types.htmlField': 'Rich Text',
    'editor.acceptedAnswers': 'Accepted Answers',
    'editor.addAnswer': 'Add Answer',
    'editor.remove': 'Remove',
    'editor.coverImage': 'Cover Image',
    'editor.coverImageUpload': 'Upload image file',
    'editor.htmlContent': 'HTML Content',
    'editor.questionHtmlPlaceholder': 'Enter HTML (e.g., <p>...</p> or <img src="..." />)',
    'editor.htmlHint': 'Supports images, formatting, and TeX formulas.',

    'quiz.previous': 'Previous',
    'quiz.next': 'Next',
    'quiz.finish': 'Finish',
    'quiz.exit': 'Exit',
    'quiz.reviewAnswers': 'Review Answers',
    'quiz.completed': 'Quiz Completed!',
    'quiz.scored': 'You scored {score} out of {total}',
    'quiz.questionCounter': 'Question {current} / {total}',
    'quiz.timeLeft': 'Time Left',
    'quiz.reviewMode': 'Review Mode',
    'quiz.score': 'Score',
    'quiz.questions': 'Questions',
    'quiz.total': 'Total',
    'quiz.answered': 'Answered',
    'quiz.correct': 'Correct',
    'quiz.showImmediate': 'Show results immediately',
    'quiz.interface.switch': 'Interface',
    'quiz.interface.default': 'Default',
    'quiz.interface.bttn': 'BaitapTracNghiem',
    'common.loading': 'Loading...',
    'common.errorLabel': 'Error:',
    'actions.goBackHistory': 'Go Back to History',
    'actions.goDashboard': 'Go to Dashboard',
    'actions.goGroups': 'Go to Groups',
    'errors.dumpNotFound': 'Dump not found',
    'errors.failedToLoadDump': 'Failed to load dump',
    'errors.invalidDumpId': 'Invalid dump ID',
    'errors.loadingReview': 'Loading quiz for review...',
    'errors.reviewDescription': "The quiz you're trying to review may have been deleted or you don't have access to it.",
    'errors.dumpHasNoQuestions': 'This dump has no questions',
    'errors.loadingSharedQuiz': 'Loading shared quiz...',
    'errors.shared.dumpNotFoundOrNotShared': 'Dump not found or not shared',
    'errors.shared.private': 'This dump is private and cannot be shared',
    'errors.shared.failedToLoad': 'Failed to load shared dump',
    'errors.linkInvalidOrDeleted': 'This quiz may be private, deleted, or the link is invalid.',
    'errors.originalDumpMissing': 'Original dump not found (might be deleted).',
    'errors.failedReviewLoad': 'Failed to load dump for review',
    'errors.quiz.noQuestionsAvailable': 'No questions available',
    'errors.quiz.questionNotFound': 'Question not found',
    'errors.failedToLoadDumps': 'Failed to load dumps',
    'invitation.joinedGroup': 'Joined group',
    'invitation.failedAccept': 'Failed to accept invitation',
    'invitation.accepting': 'Accepting invitation...',
    'groups.title': 'Groups',
    'groups.searchPlaceholder': 'Search groups',
    'groups.yourGroups': 'Your Groups',
    'groups.create': 'Create',
    'groups.manage': 'Manage',
    'groups.noGroups': 'No groups yet',
    'groups.memberOf': 'Member Of',
    'groups.noMemberships': 'No memberships',
    'groups.createGroup': 'Create Group',
    'groups.new': 'New',
    'groups.all': 'All',
    'groups.table.name': 'Name',
    'groups.table.description': 'Description',
    'groups.table.owner': 'Owner',
    'groups.table.members': 'Members',
    'groups.table.updated': 'Updated',
    'groups.table.type': 'Type',
    'groups.table.actions': 'Actions',
    'groups.table.search': 'Search',
    'groups.table.noGroupsFound': 'No groups found',
    'groups.selectHint': 'Select a group to manage its members and roles.',
    'groups.tabs.overview': 'Overview',
    'groups.tabs.members': 'Members',
    'groups.tabs.roles': 'Roles',
    'groups.tabs.settings': 'Settings',
    'groups.overviewHelp': 'Manage your group. Use tabs to invite members and configure permissions.',
    'groups.invite': 'Invite',
    'groups.optionalUsername': 'optional username',
    'groups.generateLink': 'Generate Link',
    'groups.copy': 'Copy',
    'groups.inviteUser': 'Invite User',
    'groups.usernameRequired': 'Username is required',
    'groups.failedToLoadGroups': 'Failed to load groups. Is backend running on 3000?',
    'groups.nameRequired': 'Group name is required',
    'groups.inviteLinkGenerated': 'Invite link generated',
    'groups.userAddedToGroup': 'User added to group',
    'groups.noMembersYet': 'No members yet',
    'groups.addRole': 'Add Role',
    'groups.role.name': 'Name',
    'groups.role.create': 'Create',
    'groups.role.read': 'Read',
    'groups.role.update': 'Update',
    'groups.role.delete': 'Delete',
    'groups.role.save': 'Save',
    'groups.role.noRolesYet': 'No roles yet',
    'groups.role.noRole': 'No Role',
    'groups.settings.edit': 'Edit Group',
    'groups.settings.placeholder': 'Settings are coming soon',
    'groups.modal.create.title': 'Create Group',
    'groups.modal.edit.title': 'Edit Group',
    'common.create': 'Create',
    'common.close': 'Close',
    'history.title': 'Quiz History',
    'history.searchPlaceholder': 'Search history...',
    'history.summary.attempts': 'Attempts:',
    'history.summary.average': 'Average:',
    'history.summary.passRate': 'Pass rate:',
    'history.empty.noAttempts': 'No attempts yet',
    'history.empty.noHistory': 'No history found',
    'history.empty.tryDifferent': 'Try a different search term.',
    'history.empty.startFromDashboard': 'Start a quiz from the dashboard to track your progress!',
    'history.badge.passed': 'Passed',
    'history.badge.failed': 'Failed',
    'history.score': 'Score',
    'history.review': 'Review',
    'history.unknownDump': 'Unknown Dump',
    'admin.title': 'Admin Dashboard',
    'admin.tabs.analytics': 'Analytics',
    'admin.tabs.users': 'Users',
    'admin.tabs.categories': 'Categories',
    'admin.tabs.dumps': 'Dumps',
    'admin.tabs.groups': 'Groups',
    'admin.tabs.questions': 'Questions',
    'admin.dashboard.platformOverview': 'Platform Overview',
    'admin.dashboard.totalUsers': 'Total Users',
    'admin.dashboard.totalDumps': 'Total Dumps',
    'admin.dashboard.quizzesTaken': 'Quizzes Taken',
    'admin.dashboard.avgScore': 'Avg Score',
    'admin.dashboard.popularDumps': 'Most Popular Dumps',
    'admin.dashboard.dumpsByCategory': 'Dumps by Category',
    'admin.dashboard.quizzesByDate': 'Quizzes by Date (30 days)',
    'admin.common.quizzes': 'Quizzes',
    'admin.popular.dumpName': 'Dump Name',
    'admin.popular.attempts': 'Attempts',
    'admin.common.category': 'Category',
    'admin.common.count': 'Count',
    'admin.common.date': 'Date',
    'admin.users.management': 'User Management',
    'admin.users.searchUsername': 'Search username',
    'admin.common.all': 'All',
    'admin.common.yes': 'Yes',
    'admin.common.no': 'No',
    'admin.table.username': 'Username',
    'admin.table.role': 'Role',
    'admin.table.dumps': 'Dumps',
    'admin.table.quizzes': 'Quizzes',
    'admin.table.avgScore': 'Avg Score',
    'admin.table.joined': 'Joined',
    'admin.table.actions': 'Actions',
    'admin.action.deleteUser': 'Delete User',
    'admin.dumps.all': 'All Dumps',
    'admin.dumps.search': 'Search dumps',
    'admin.dumps.name': 'Name',
    'admin.dumps.category': 'Category',
    'admin.dumps.owner': 'Owner',
    'admin.dumps.questions': 'Questions',
    'admin.dumps.public': 'Public',
    'admin.dumps.created': 'Created',
    'admin.action.edit': 'Edit',
    'admin.action.delete': 'Delete',
    'admin.groups.all': 'All Groups',
    'admin.groups.search': 'Search name or owner',
    'admin.groups.status': 'Status',
    'admin.groups.manage': 'Manage',
    'admin.groups.active': 'Active',
    'admin.groups.inactive': 'Inactive',
    'admin.questions.all': 'All Questions',
    'admin.questions.search': 'Search question or dump',
    'admin.questions.allGroups': 'All Groups',
    'admin.questions.exactMatch': 'Exact match',
    'admin.questions.filter': 'Filter',
    'admin.questions.export': 'Export',
    'admin.questions.question': 'Question',
    'admin.questions.dump': 'Dump',
    'admin.questions.owner': 'Owner',
    'admin.questions.groups': 'Groups',
    'admin.categories.management': 'Category Management',
    'admin.categories.searchPlaceholder': 'Search code, name, description',
    'admin.categories.add': 'Add Category',
    'admin.categories.edit': 'Edit Category',
    'admin.categories.code': 'Code (e.g., CSA)',
    'admin.categories.name': 'Name',
    'admin.categories.description': 'Description (optional)',
    'admin.categories.public': 'Public',
    'admin.categories.groupOptional': 'Group (optional)',
    'admin.categories.group': 'Group',
    'admin.categories.count': '{count} categories',
    'admin.categories.placeholder.code': 'CSA',
    'admin.categories.placeholder.name': 'CSA - Certified System Administrator',
    'admin.categories.placeholder.description': 'ServiceNow System Administrator certification',
    'admin.common.none': 'None',
    'admin.common.cancel': 'Cancel',
    'admin.common.update': 'Update',
    'admin.common.close': 'Close',
    'admin.manageGroup.title': 'Manage Group',
    'admin.manageGroup.status': 'Status:',
    'admin.manageGroup.setInactive': 'Set Inactive',
    'admin.manageGroup.setActive': 'Set Active',
    'admin.manageGroup.member': 'Member',
    'admin.manageGroup.role': 'Role',
    'admin.history.titleForDate': 'Quiz History for {date}'
  },
  vi: {
    'brand.name': 'Dumps Master',
    'nav.dashboard': 'B·∫£ng ƒëi·ªÅu khi·ªÉn',
    'nav.history': 'L·ªãch s·ª≠',
    'nav.groups': 'Nh√≥m',
    'nav.admin': 'Qu·∫£n tr·ªã',
    'nav.profile': 'H·ªì s∆°',
    'nav.logout': 'ƒêƒÉng xu·∫•t',
    'nav.toggleTheme': 'ƒê·ªïi giao di·ªán',
    'footer.built': 'X√¢y d·ª±ng ƒë·ªÉ h·ªçc t·∫≠p.',

    'auth.login': 'ƒêƒÉng nh·∫≠p',
    'auth.signup': 'ƒêƒÉng k√Ω',
    'auth.email': 'Email',
    'auth.password': 'M·∫≠t kh·∫©u',
    'auth.confirmPassword': 'X√°c nh·∫≠n m·∫≠t kh·∫©u',
    'auth.togglePrefix.login': 'Ch∆∞a c√≥ t√†i kho·∫£n? ',
    'auth.toggleLink.login': 'ƒêƒÉng k√Ω',
    'auth.togglePrefix.signup': 'ƒê√£ c√≥ t√†i kho·∫£n? ',
    'auth.toggleLink.signup': 'ƒêƒÉng nh·∫≠p',

    'dashboard.loading': 'ƒêang t·∫£i ƒë·ªÅ thi...',
    'dashboard.empty': 'Kh√¥ng c√≥ b·ªô c√¢u h·ªèi',
    'hero.badge': 'N·ªÅn t·∫£ng luy·ªán thi',
    'hero.title': 'Trung t√¢m luy·ªán thi c·ªßa b·∫°n',
    'hero.subtitle': 'Luy·ªán t·∫≠p v·ªõi b·ªô c√¢u h·ªèi, t·∫£i l√™n c√¢u h·ªèi c·ªßa b·∫°n v√† kh√°m ph√° th∆∞ vi·ªán c√¥ng khai. Chinh ph·ª•c ch·ª©ng ch·ªâ v·ªõi b√†i ki·ªÉm tra t∆∞∆°ng t√°c.',
    'tour.title': 'Ch√†o m·ª´ng ƒë·∫øn Dumps Master! üéì',
    'tour.howto': 'C√°ch s·ª≠ d·ª•ng ·ª©ng d·ª•ng:',
    'tour.step1.title': 'T·∫£i file m·∫´u',
    'tour.step1.desc': 'T·∫£i file m·∫´u ƒë·ªÉ xem ƒë√∫ng ƒë·ªãnh d·∫°ng.',
    'tour.step1.cta': 'üì• T·∫£i file m·∫´u',
    'tour.step2.title': 'Ch·ªânh s·ª≠a b·ªô ƒë·ªÅ',
    'tour.step2.desc': 'M·ªü file CSV b·∫±ng Excel ho·∫∑c Google Sheets. Th√™m c√¢u h·ªèi theo ƒë√∫ng ƒë·ªãnh d·∫°ng:',
    'tour.step2.listA': 'C·ªôt A: N·ªôi dung c√¢u h·ªèi',
    'tour.step2.listB': 'C·ªôt B-E: C√°c l·ª±a ch·ªçn (A, B, C, D)',
    'tour.step2.listC': 'C·ªôt F: ƒê√°p √°n ƒë√∫ng (A, B, C ho·∫∑c D)',
    'tour.step3.title': 'T·∫£i l√™n b·ªô ƒë·ªÅ',
    'tour.step3.desc': 'Nh·∫•n n√∫t "Th√™m m·ªõi" ph√≠a d∆∞·ªõi v√† t·∫£i l√™n file CSV ƒë√£ ch·ªânh s·ª≠a. B·∫°n c√≥ th·ªÉ ƒë·∫∑t c√¥ng khai ho·∫∑c ri√™ng t∆∞.',
    'tour.step4.title': 'B·∫Øt ƒë·∫ßu luy·ªán t·∫≠p!',
    'tour.step4.desc': 'Nh·∫•n "Xem" tr√™n b·∫•t k·ª≥ b·ªô ƒë·ªÅ n√†o ƒë·ªÉ b·∫Øt ƒë·∫ßu l√†m b√†i. B·∫°n c≈©ng c√≥ th·ªÉ kh√°m ph√° th∆∞ vi·ªán c√¥ng khai ƒë·ªÉ luy·ªán t·∫≠p t·ª´ b·ªô ƒë·ªÅ c·ªßa ng∆∞·ªùi kh√°c.',
    'tour.close': 'ƒê√£ hi·ªÉu, b·∫Øt ƒë·∫ßu th√¥i!',
    'section.available': 'B·ªô ƒë·ªÅ hi·ªán c√≥',
    'tabs.my': 'B·ªô ƒë·ªÅ c·ªßa t√¥i',
    'tabs.group': 'Nh√≥m',
    'tabs.public': 'C√¥ng khai',
    'search.placeholder': 'T√¨m b·ªô ƒë·ªÅ theo t√™n...',
    'filter.all': 'T·∫•t c·∫£ danh m·ª•c',
    'filter.uncategorized': 'Ch∆∞a ph√¢n lo·∫°i',
    'button.addNew': 'Th√™m m·ªõi',
    'modal.quickUpload.title': 'T·∫£i l√™n nhanh',
    'card.selfPaced': 'T·ª± h·ªçc',
    'card.view': 'Xem',
    'tooltip.edit': 'S·ª≠a',
    'tooltip.delete': 'X√≥a',
    'empty.hint.search': 'H√£y ƒëi·ªÅu ch·ªânh t√¨m ki·∫øm ho·∫∑c b·ªô l·ªçc ƒë·ªÉ t√¨m n·ªôi dung ph√π h·ª£p.',
    'empty.hint.my': 'B·∫Øt ƒë·∫ßu b·∫±ng c√°ch t·∫£i l√™n b·ªô ƒë·ªÅ ƒë·∫ßu ti√™n b·∫±ng n√∫t "Th√™m m·ªõi" ·ªü tr√™n.',
    'empty.hint.public': 'Ch∆∞a c√≥ b·ªô ƒë·ªÅ c√¥ng khai. Quay l·∫°i sau ho·∫∑c t·∫°o b·ªô ƒë·ªÅ c·ªßa ri√™ng b·∫°n!',
    'empty.createFirst': 'T·∫°o b·ªô ƒë·ªÅ ƒë·∫ßu ti√™n',
    'common.cancel': 'H·ªßy',
    'common.saveChanges': 'L∆∞u thay ƒë·ªïi',
    'common.shareToGroups': 'Chia s·∫ª cho Nh√≥m',
    'common.export': 'Xu·∫•t',
    'common.import': 'Nh·∫≠p',
    'common.name': 'T√™n',
    'common.description': 'M√¥ t·∫£',
    'editor.title': 'Ch·ªânh s·ª≠a B·ªô ƒë·ªÅ',
    'editor.questions': 'C√¢u h·ªèi',
    'editor.addQuestion': 'Th√™m c√¢u h·ªèi',
    'editor.editQuestion': 'S·ª≠a c√¢u h·ªèi',
    'editor.correctAnswers': 'ƒê√°p √°n ƒë√∫ng',
    'editor.settings': 'C√†i ƒë·∫∑t',
    'editor.dumpName': 'T√™n b·ªô ƒë·ªÅ',
    'editor.enterDumpName': 'Nh·∫≠p t√™n b·ªô ƒë·ªÅ',
    'editor.visibility': 'Ch·∫ø ƒë·ªô hi·ªÉn th·ªã',
    'editor.private': 'Ri√™ng t∆∞',
    'editor.public': 'C√¥ng khai',
    'editor.category': 'Danh m·ª•c',
    'editor.quizMode': 'Ch·∫ø ƒë·ªô l√†m b√†i',
    'editor.practice': 'Luy·ªán t·∫≠p',
    'editor.exam': 'Thi',
    'editor.practiceHint': 'Xem ƒë√°p √°n ngay sau m·ªói c√¢u.',
    'editor.examHint': 'L√†m h·∫øt c√¢u h·ªèi r·ªìi xem ƒë√°p √°n ·ªü cu·ªëi.',
    'editor.timeLimitMinutes': 'Gi·ªõi h·∫°n th·ªùi gian (ph√∫t)',
    'editor.noLimitHint': 'ƒê·∫∑t 0 ƒë·ªÉ kh√¥ng gi·ªõi h·∫°n',
    'editor.questionText': 'N·ªôi dung c√¢u h·ªèi',
    'editor.optionLabel': 'L·ª±a ch·ªçn {opt}',
    'editor.optionPlaceholder': 'L·ª±a ch·ªçn {opt}',
    'editor.answerLabel': 'ƒê√°p √°n',
    'editor.optionsCount': '{count} l·ª±a ch·ªçn',
    'editor.deleteQuestion': 'X√≥a c√¢u h·ªèi',
    'editor.emptyNoQuestions': 'Ch∆∞a c√≥ c√¢u h·ªèi. H√£y th√™m ƒë·ªÉ b·∫Øt ƒë·∫ßu!',
    'editor.updateQuestion': 'C·∫≠p nh·∫≠t c√¢u h·ªèi',
    'editor.filterGroups': 'L·ªçc nh√≥m',
    'editor.selectedCount': '{count} m·ª•c ƒë√£ ch·ªçn',
    'editor.clearSelection': 'X√≥a l·ª±a ch·ªçn',
    'editor.unshareAll': 'G·ª° chia s·∫ª t·∫•t c·∫£',
    'editor.duplicates.title': 'Ph√°t hi·ªán c√¢u h·ªèi tr√πng l·∫∑p',
    'editor.duplicates.skip': 'B·ªè qua c√¢u tr√πng',
    'editor.duplicates.replace': 'Thay th·∫ø c√¢u tr√πng',
    'editor.duplicates.merge': 'G·ªôp t·∫•t c·∫£',
    'editor.multipleCorrectHint': 'C√≥ th·ªÉ ch·ªçn nhi·ªÅu ƒë√°p √°n ƒë√∫ng',
    'editor.questionType': 'Lo·∫°i c√¢u h·ªèi',
    'editor.types.multipleSingle': 'Nhi·ªÅu l·ª±a ch·ªçn (1 ƒë√°p √°n)',
    'editor.types.multipleMultiple': 'Nhi·ªÅu l·ª±a ch·ªçn (nhi·ªÅu ƒë√°p √°n)',
    'editor.types.trueFalse': 'ƒê√∫ng / Sai',
    'editor.types.shortAnswer': 'Tr·∫£ l·ªùi ng·∫Øn',
    'editor.types.htmlField': 'So·∫°n th·∫£o t·ª± do',
    'editor.acceptedAnswers': 'C√°c ƒë√°p √°n ch·∫•p nh·∫≠n',
    'editor.addAnswer': 'Th√™m ƒë√°p √°n',
    'editor.remove': 'X√≥a',
    'editor.coverImage': '·∫¢nh n·ªÅn th·∫ª',
    'editor.coverImageUpload': 'T·∫£i ·∫£nh l√™n',
    'editor.htmlContent': 'N·ªôi dung ƒë·ªãnh d·∫°ng',
    'editor.questionHtmlPlaceholder': 'Nh·∫≠p HTML (v√≠ d·ª•: <p>...</p> ho·∫∑c <img src="..." />)',
    'editor.htmlHint': 'H·ªó tr·ª£ HTML c∆° b·∫£n nh∆∞ <img>, <b>, <i>.',

    'quiz.previous': 'Tr∆∞·ªõc',
    'quiz.next': 'Ti·∫øp',
    'quiz.finish': 'Ho√†n th√†nh',
    'quiz.exit': 'Tho√°t',
    'quiz.reviewAnswers': 'Xem l·∫°i ƒë√°p √°n',
    'quiz.completed': 'Ho√†n th√†nh b√†i ki·ªÉm tra!',
    'quiz.scored': 'B·∫°n ƒë·∫°t {score} tr√™n {total}',
    'quiz.questionCounter': 'C√¢u {current} / {total}',
    'quiz.timeLeft': 'Th·ªùi gian c√≤n l·∫°i',
    'quiz.reviewMode': 'Ch·∫ø ƒë·ªô xem l·∫°i',
    'quiz.score': 'ƒêi·ªÉm',
    'quiz.questions': 'Danh s√°ch c√¢u h·ªèi',
    'quiz.total': 'T·ªïng',
    'quiz.answered': 'ƒê√£ tr·∫£ l·ªùi',
    'quiz.correct': 'ƒê√∫ng',
    'quiz.showImmediate': 'Hi·ªÉn th·ªã k·∫øt qu·∫£ ngay sau khi tr·∫£ l·ªùi',
    'quiz.interface.switch': 'Giao di·ªán',
    'quiz.interface.default': 'M·∫∑c ƒë·ªãnh',
    'quiz.interface.bttn': 'BaitapTracNghiem',
    'common.loading': 'ƒêang t·∫£i...',
    'common.errorLabel': 'L·ªói:',
    'actions.goBackHistory': 'Quay l·∫°i L·ªãch s·ª≠',
    'actions.goDashboard': 'V·ªÅ B·∫£ng ƒëi·ªÅu khi·ªÉn',
    'actions.goGroups': 'V·ªÅ Nh√≥m',
    'errors.dumpNotFound': 'Kh√¥ng t√¨m th·∫•y b·ªô ƒë·ªÅ',
    'errors.failedToLoadDump': 'Kh√¥ng t·∫£i ƒë∆∞·ª£c b·ªô ƒë·ªÅ',
    'errors.invalidDumpId': 'ID b·ªô ƒë·ªÅ kh√¥ng h·ª£p l·ªá',
    'errors.loadingReview': 'ƒêang t·∫£i b√†i ƒë·ªÉ xem l·∫°i...',
    'errors.reviewDescription': 'B√†i b·∫°n mu·ªën xem l·∫°i c√≥ th·ªÉ ƒë√£ b·ªã x√≥a ho·∫∑c b·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p.',
    'errors.dumpHasNoQuestions': 'B·ªô ƒë·ªÅ n√†y kh√¥ng c√≥ c√¢u h·ªèi',
    'errors.loadingSharedQuiz': 'ƒêang t·∫£i b√†i luy·ªán chia s·∫ª...',
    'errors.shared.dumpNotFoundOrNotShared': 'Kh√¥ng t√¨m th·∫•y ho·∫∑c ch∆∞a chia s·∫ª b·ªô ƒë·ªÅ',
    'errors.shared.private': 'B·ªô ƒë·ªÅ n√†y ·ªü ch·∫ø ƒë·ªô ri√™ng t∆∞, kh√¥ng th·ªÉ chia s·∫ª',
    'errors.shared.failedToLoad': 'Kh√¥ng t·∫£i ƒë∆∞·ª£c b·ªô ƒë·ªÅ chia s·∫ª',
    'errors.linkInvalidOrDeleted': 'B√†i luy·ªán c√≥ th·ªÉ ·ªü ch·∫ø ƒë·ªô ri√™ng t∆∞, ƒë√£ x√≥a ho·∫∑c li√™n k·∫øt kh√¥ng h·ª£p l·ªá.',
    'errors.originalDumpMissing': 'Kh√¥ng t√¨m th·∫•y b·ªô ƒë·ªÅ g·ªëc (c√≥ th·ªÉ ƒë√£ b·ªã x√≥a).',
    'errors.failedReviewLoad': 'Kh√¥ng t·∫£i ƒë∆∞·ª£c b·ªô ƒë·ªÅ ƒë·ªÉ xem l·∫°i',
    'errors.quiz.noQuestionsAvailable': 'Kh√¥ng c√≥ c√¢u h·ªèi',
    'errors.quiz.questionNotFound': 'Kh√¥ng t√¨m th·∫•y c√¢u h·ªèi',
    'errors.failedToLoadDumps': 'Kh√¥ng t·∫£i ƒë∆∞·ª£c danh s√°ch b·ªô ƒë·ªÅ',
    'invitation.joinedGroup': 'ƒê√£ tham gia nh√≥m',
    'invitation.failedAccept': 'Kh√¥ng ch·∫•p nh·∫≠n ƒë∆∞·ª£c l·ªùi m·ªùi',
    'invitation.accepting': 'ƒêang ch·∫•p nh·∫≠n l·ªùi m·ªùi...',
    'groups.title': 'Nh√≥m',
    'groups.searchPlaceholder': 'T√¨m ki·∫øm nh√≥m',
    'groups.yourGroups': 'Nh√≥m c·ªßa b·∫°n',
    'groups.create': 'T·∫°o',
    'groups.manage': 'Qu·∫£n l√Ω',
    'groups.noGroups': 'Ch∆∞a c√≥ nh√≥m',
    'groups.memberOf': 'Th√†nh vi√™n c·ªßa',
    'groups.noMemberships': 'Ch∆∞a tham gia nh√≥m n√†o',
    'groups.createGroup': 'T·∫°o Nh√≥m',
    'groups.new': 'M·ªõi',
    'groups.all': 'T·∫•t c·∫£',
    'groups.table.name': 'T√™n',
    'groups.table.description': 'M√¥ t·∫£',
    'groups.table.owner': 'Ch·ªß s·ªü h·ªØu',
    'groups.table.members': 'Th√†nh vi√™n',
    'groups.table.updated': 'C·∫≠p nh·∫≠t',
    'groups.table.type': 'Lo·∫°i',
    'groups.table.actions': 'Thao t√°c',
    'groups.table.search': 'T√¨m ki·∫øm',
    'groups.table.noGroupsFound': 'Kh√¥ng t√¨m th·∫•y nh√≥m',
    'groups.selectHint': 'Ch·ªçn m·ªôt nh√≥m ƒë·ªÉ qu·∫£n l√Ω th√†nh vi√™n v√† vai tr√≤.',
    'groups.tabs.overview': 'T·ªïng quan',
    'groups.tabs.members': 'Th√†nh vi√™n',
    'groups.tabs.roles': 'Vai tr√≤',
    'groups.tabs.settings': 'C√†i ƒë·∫∑t',
    'groups.overviewHelp': 'Qu·∫£n l√Ω nh√≥m c·ªßa b·∫°n. D√πng c√°c tab ƒë·ªÉ m·ªùi th√†nh vi√™n v√† c·∫•u h√¨nh quy·ªÅn.',
    'groups.invite': 'M·ªùi',
    'groups.optionalUsername': 't√™n ng∆∞·ªùi d√πng (kh√¥ng b·∫Øt bu·ªôc)',
    'groups.generateLink': 'T·∫°o li√™n k·∫øt',
    'groups.copy': 'Sao ch√©p',
    'groups.inviteUser': 'M·ªùi th√†nh vi√™n',
    'groups.usernameRequired': 'C·∫ßn nh·∫≠p username',
    'groups.failedToLoadGroups': 'Kh√¥ng t·∫£i ƒë∆∞·ª£c danh s√°ch nh√≥m. Backend c√≥ ch·∫°y tr√™n 3000 kh√¥ng?',
    'groups.nameRequired': 'T√™n nh√≥m l√† b·∫Øt bu·ªôc',
    'groups.inviteLinkGenerated': 'ƒê√£ t·∫°o li√™n k·∫øt m·ªùi',
    'groups.userAddedToGroup': 'ƒê√£ th√™m ng∆∞·ªùi d√πng v√†o nh√≥m',
    'groups.noMembersYet': 'Ch∆∞a c√≥ th√†nh vi√™n',
    'groups.addRole': 'Th√™m vai tr√≤',
    'groups.role.name': 'T√™n',
    'groups.role.create': 'T·∫°o',
    'groups.role.read': 'Xem',
    'groups.role.update': 'S·ª≠a',
    'groups.role.delete': 'X√≥a',
    'groups.role.save': 'L∆∞u',
    'groups.role.noRolesYet': 'Ch∆∞a c√≥ vai tr√≤',
    'groups.role.noRole': 'Kh√¥ng c√≥ vai tr√≤',
    'groups.settings.edit': 'S·ª≠a nh√≥m',
    'groups.settings.placeholder': 'T√≠nh nƒÉng c√†i ƒë·∫∑t s·∫Ω ƒë∆∞·ª£c b·ªï sung',
    'groups.modal.create.title': 'T·∫°o Nh√≥m',
    'groups.modal.edit.title': 'S·ª≠a Nh√≥m',
    'common.create': 'T·∫°o',
    'common.close': 'ƒê√≥ng',
    'history.title': 'L·ªãch s·ª≠ l√†m b√†i',
    'history.searchPlaceholder': 'T√¨m l·ªãch s·ª≠...',
    'history.summary.attempts': 'L·∫ßn l√†m:',
    'history.summary.average': 'Trung b√¨nh:',
    'history.summary.passRate': 'T·ª∑ l·ªá ƒë·∫≠u:',
    'history.empty.noAttempts': 'Ch∆∞a c√≥ l∆∞·ª£t l√†m n√†o',
    'history.empty.noHistory': 'Kh√¥ng c√≥ l·ªãch s·ª≠',
    'history.empty.tryDifferent': 'H√£y th·ª≠ t·ª´ kh√≥a kh√°c.',
    'history.empty.startFromDashboard': 'B·∫Øt ƒë·∫ßu m·ªôt b√†i ki·ªÉm tra t·ª´ b·∫£ng ƒëi·ªÅu khi·ªÉn ƒë·ªÉ theo d√µi ti·∫øn tr√¨nh!',
    'history.badge.passed': 'ƒê·∫°t',
    'history.badge.failed': 'Ch∆∞a ƒë·∫°t',
    'history.score': 'ƒêi·ªÉm',
    'history.review': 'Xem l·∫°i',
    'history.unknownDump': 'B·ªô ƒë·ªÅ kh√¥ng x√°c ƒë·ªãnh',
    'admin.title': 'B·∫£ng Qu·∫£n tr·ªã',
    'admin.tabs.analytics': 'Ph√¢n t√≠ch',
    'admin.tabs.users': 'Ng∆∞·ªùi d√πng',
    'admin.tabs.categories': 'Danh m·ª•c',
    'admin.tabs.dumps': 'B·ªô ƒë·ªÅ',
    'admin.tabs.groups': 'Nh√≥m',
    'admin.tabs.questions': 'C√¢u h·ªèi',
    'admin.dashboard.platformOverview': 'T·ªïng quan n·ªÅn t·∫£ng',
    'admin.dashboard.totalUsers': 'T·ªïng ng∆∞·ªùi d√πng',
    'admin.dashboard.totalDumps': 'T·ªïng b·ªô ƒë·ªÅ',
    'admin.dashboard.quizzesTaken': 'S·ªë b√†i ƒë√£ l√†m',
    'admin.dashboard.avgScore': 'ƒêi·ªÉm trung b√¨nh',
    'admin.dashboard.popularDumps': 'B·ªô ƒë·ªÅ ph·ªï bi·∫øn',
    'admin.dashboard.dumpsByCategory': 'B·ªô ƒë·ªÅ theo danh m·ª•c',
    'admin.dashboard.quizzesByDate': 'B√†i l√†m theo ng√†y (30 ng√†y)',
    'admin.common.quizzes': 'B√†i l√†m',
    'admin.popular.dumpName': 'T√™n b·ªô ƒë·ªÅ',
    'admin.popular.attempts': 'S·ªë l∆∞·ª£t l√†m',
    'admin.common.category': 'Danh m·ª•c',
    'admin.common.count': 'S·ªë l∆∞·ª£ng',
    'admin.common.date': 'Ng√†y',
    'admin.users.management': 'Qu·∫£n l√Ω ng∆∞·ªùi d√πng',
    'admin.users.searchUsername': 'T√¨m t√™n ng∆∞·ªùi d√πng',
    'admin.common.all': 'T·∫•t c·∫£',
    'admin.common.yes': 'C√≥',
    'admin.common.no': 'Kh√¥ng',
    'admin.table.username': 'T√™n ng∆∞·ªùi d√πng',
    'admin.table.role': 'Vai tr√≤',
    'admin.table.dumps': 'B·ªô ƒë·ªÅ',
    'admin.table.quizzes': 'B√†i l√†m',
    'admin.table.avgScore': 'ƒêi·ªÉm TB',
    'admin.table.joined': 'Tham gia',
    'admin.table.actions': 'Thao t√°c',
    'admin.action.deleteUser': 'X√≥a ng∆∞·ªùi d√πng',
    'admin.dumps.all': 'T·∫•t c·∫£ b·ªô ƒë·ªÅ',
    'admin.dumps.search': 'T√¨m b·ªô ƒë·ªÅ',
    'admin.dumps.name': 'T√™n',
    'admin.dumps.category': 'Danh m·ª•c',
    'admin.dumps.owner': 'Ch·ªß s·ªü h·ªØu',
    'admin.dumps.questions': 'C√¢u h·ªèi',
    'admin.dumps.public': 'C√¥ng khai',
    'admin.dumps.created': 'T·∫°o l√∫c',
    'admin.action.edit': 'S·ª≠a',
    'admin.action.delete': 'X√≥a',
    'admin.groups.all': 'T·∫•t c·∫£ nh√≥m',
    'admin.groups.search': 'T√¨m theo t√™n ho·∫∑c ch·ªß s·ªü h·ªØu',
    'admin.groups.status': 'Tr·∫°ng th√°i',
    'admin.groups.manage': 'Qu·∫£n l√Ω',
    'admin.groups.active': 'ƒêang ho·∫°t ƒë·ªông',
    'admin.groups.inactive': 'Ng·ª´ng ho·∫°t ƒë·ªông',
    'admin.questions.all': 'T·∫•t c·∫£ c√¢u h·ªèi',
    'admin.questions.search': 'T√¨m c√¢u h·ªèi ho·∫∑c b·ªô ƒë·ªÅ',
    'admin.questions.allGroups': 'T·∫•t c·∫£ nh√≥m',
    'admin.questions.exactMatch': 'Kh·ªõp ch√≠nh x√°c',
    'admin.questions.filter': 'L·ªçc',
    'admin.questions.export': 'Xu·∫•t',
    'admin.questions.question': 'C√¢u h·ªèi',
    'admin.questions.dump': 'B·ªô ƒë·ªÅ',
    'admin.questions.owner': 'Ch·ªß s·ªü h·ªØu',
    'admin.questions.groups': 'Nh√≥m',
    'admin.categories.management': 'Qu·∫£n l√Ω danh m·ª•c',
    'admin.categories.searchPlaceholder': 'T√¨m m√£, t√™n, m√¥ t·∫£',
    'admin.categories.add': 'Th√™m danh m·ª•c',
    'admin.categories.edit': 'S·ª≠a danh m·ª•c',
    'admin.categories.code': 'M√£ (v√≠ d·ª•: CSA)',
    'admin.categories.name': 'T√™n',
    'admin.categories.description': 'M√¥ t·∫£ (kh√¥ng b·∫Øt bu·ªôc)',
    'admin.categories.public': 'C√¥ng khai',
    'admin.categories.groupOptional': 'Nh√≥m (kh√¥ng b·∫Øt bu·ªôc)',
    'admin.categories.group': 'Nh√≥m',
    'admin.categories.count': '{count} danh m·ª•c',
    'admin.categories.placeholder.code': 'CSA',
    'admin.categories.placeholder.name': 'CSA - Qu·∫£n tr·ªã h·ªá th·ªëng',
    'admin.categories.placeholder.description': 'Ch·ª©ng ch·ªâ Qu·∫£n tr·ªã h·ªá th·ªëng ServiceNow',
    'admin.common.none': 'Kh√¥ng',
    'admin.common.cancel': 'H·ªßy',
    'admin.common.update': 'C·∫≠p nh·∫≠t',
    'admin.common.close': 'ƒê√≥ng',
    'admin.manageGroup.title': 'Qu·∫£n l√Ω nh√≥m',
    'admin.manageGroup.status': 'Tr·∫°ng th√°i:',
    'admin.manageGroup.setInactive': 'Ng·ª´ng ho·∫°t ƒë·ªông',
    'admin.manageGroup.setActive': 'K√≠ch ho·∫°t',
    'admin.manageGroup.member': 'Th√†nh vi√™n',
    'admin.manageGroup.role': 'Vai tr√≤',
    'admin.history.titleForDate': 'L·ªãch s·ª≠ l√†m b√†i ng√†y {date}'
  }
};

export const I18nProvider = ({ children }) => {
  const [lang, setLang] = useState('vi');

  useEffect(() => {
    const saved = localStorage.getItem('lang');
    if (saved) setLang(saved);
  }, []);

  useEffect(() => {
    localStorage.setItem('lang', lang);
  }, [lang]);

  const t = useMemo(() => {
    return (key, vars = {}) => {
      const str = (DICT[lang] && DICT[lang][key]) || DICT.en[key] || key;
      return str.replace(/\{(\w+)\}/g, (_, k) => (vars[k] !== undefined ? String(vars[k]) : `{${k}}`));
    };
  }, [lang]);

  const value = useMemo(() => ({ t, lang, setLang }), [t, lang]);
  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
};

export const useI18n = () => useContext(I18nContext);

import React, { createContext, useContext, useMemo, useState, useEffect } from 'react';

const I18nContext = createContext({ t: (k) => k, lang: 'en', setLang: () => {} });

const DICT = {
  en: {
    'brand.name': 'Dumps Master',
    'nav.dashboard': 'Dashboard',
    'nav.history': 'History',
    'nav.groups': 'Groups',
    'nav.admin': 'Admin',
    'nav.profile': 'Profile',
    'nav.logout': 'Logout',
    'nav.toggleTheme': 'Toggle Theme',
    'footer.built': 'Built for learning.',

    'auth.login': 'Login',
    'auth.signup': 'Sign Up',
    'auth.email': 'Email',
    'auth.password': 'Password',
    'auth.confirmPassword': 'Confirm Password',
    "auth.togglePrefix.login": "Don't have an account? ",
    'auth.toggleLink.login': 'Sign Up',
    'auth.togglePrefix.signup': 'Already have an account? ',
    'auth.toggleLink.signup': 'Login',

    'dashboard.loading': 'Loading dumps...',
    'dashboard.empty': 'No dumps found',
    'hero.badge': 'Exam Practice Platform',
    'hero.title': 'Your Exam Practice Hub',
    'hero.subtitle': 'Practice with exam dumps, upload your own questions, and explore the public library. Master your certification exams with interactive quizzes.',
    'tour.title': 'Welcome to Dumps Master! ðŸŽ“',
    'tour.howto': 'How to Use This App:',
    'tour.step1.title': 'Download Sample File',
    'tour.step1.desc': 'Download our sample dumps file to see the correct format.',
    'tour.step1.cta': 'Download Sample File',
    'tour.step2.title': 'Edit Your Dumps',
    'tour.step2.desc': 'Open the CSV file in Excel or Google Sheets. Add your own questions following the same format:',
    'tour.step2.listA': 'Column A: Question text',
    'tour.step2.listB': 'Columns B-E: Answer options (A, B, C, D)',
    'tour.step2.listC': 'Column F: Correct answer (A, B, C, or D)',
    'tour.step3.title': 'Upload Your Dump',
    'tour.step3.desc': 'Click the "Add New" button below and upload your edited CSV file. You can set it as public or private.',
    'tour.step4.title': 'Start Practicing!',
    'tour.step4.desc': 'Click "View" on any dump to start taking the quiz. You can also explore the Public Library to practice with dumps shared by others.',
    'tour.close': "Got it, Let's Start!",
    'section.available': 'Available Exam Dumps',
    'tabs.my': 'My Dumps',
    'tabs.group': 'Group',
    'tabs.public': 'Public',
    'search.placeholder': 'Search dumps by name...',
    'filter.all': 'All Categories',
    'filter.uncategorized': 'Uncategorized',
    'button.addNew': 'Add New',
    'modal.quickUpload.title': 'Quick Upload',
    'card.selfPaced': 'Self-paced',
    'card.view': 'View',
    'tooltip.edit': 'Edit',
    'tooltip.delete': 'Delete',
    'empty.hint.search': "Try adjusting your search or filters to find what you're looking for.",
    'empty.hint.my': 'Get started by uploading your first exam dump using the "Add New" button above.',
    'empty.hint.public': 'No public dumps available yet. Check back later or create your own!',
    'empty.createFirst': 'Create Your First Dump',
    'common.cancel': 'Cancel',
    'common.saveChanges': 'Save Changes',
    'common.shareToGroups': 'Share to Groups',
    'common.export': 'Export',
    'common.import': 'Import',
    'common.name': 'Name',
    'common.description': 'Description',
    'editor.title': 'Edit Dump',
    'editor.questions': 'Questions',
    'editor.addQuestion': 'Add Question',
    'editor.editQuestion': 'Edit Question',
    'editor.correctAnswers': 'Correct Answers',

    'quiz.previous': 'Previous',
    'quiz.next': 'Next',
    'quiz.finish': 'Finish',
    'quiz.exit': 'Exit',
    'quiz.reviewAnswers': 'Review Answers',
    'quiz.completed': 'Quiz Completed!',
    'quiz.scored': 'You scored {score} out of {total}',
    'quiz.questionCounter': 'Question {current} / {total}',
    'quiz.timeLeft': 'Time Left',
    'quiz.reviewMode': 'Review Mode',
    'quiz.score': 'Score',
    'quiz.questions': 'Questions',
    'quiz.total': 'Total',
    'quiz.answered': 'Answered',
    'quiz.correct': 'Correct',
    'common.loading': 'Loading...',
    'common.errorLabel': 'Error:',
    'actions.goBackHistory': 'Go Back to History',
    'actions.goDashboard': 'Go to Dashboard',
    'actions.goGroups': 'Go to Groups',
    'errors.dumpNotFound': 'Dump not found',
    'errors.failedToLoadDump': 'Failed to load dump',
    'errors.invalidDumpId': 'Invalid dump ID',
    'errors.loadingReview': 'Loading quiz for review...',
    'errors.reviewDescription': "The quiz you're trying to review may have been deleted or you don't have access to it.",
    'errors.dumpHasNoQuestions': 'This dump has no questions',
    'errors.loadingSharedQuiz': 'Loading shared quiz...',
    'errors.shared.dumpNotFoundOrNotShared': 'Dump not found or not shared',
    'errors.shared.private': 'This dump is private and cannot be shared',
    'errors.shared.failedToLoad': 'Failed to load shared dump',
    'errors.linkInvalidOrDeleted': 'This quiz may be private, deleted, or the link is invalid.',
    'errors.originalDumpMissing': 'Original dump not found (might be deleted).',
    'errors.failedReviewLoad': 'Failed to load dump for review',
    'errors.quiz.noQuestionsAvailable': 'No questions available',
    'errors.quiz.questionNotFound': 'Question not found',
    'errors.failedToLoadDumps': 'Failed to load dumps',
    'invitation.joinedGroup': 'Joined group',
    'invitation.failedAccept': 'Failed to accept invitation',
    'invitation.accepting': 'Accepting invitation...',
    'groups.title': 'Groups',
    'groups.searchPlaceholder': 'Search groups',
    'groups.yourGroups': 'Your Groups',
    'groups.create': 'Create',
    'groups.manage': 'Manage',
    'groups.noGroups': 'No groups yet',
    'groups.memberOf': 'Member Of',
    'groups.noMemberships': 'No memberships',
    'groups.createGroup': 'Create Group',
    'groups.new': 'New',
    'groups.all': 'All',
    'groups.table.name': 'Name',
    'groups.table.description': 'Description',
    'groups.table.owner': 'Owner',
    'groups.table.members': 'Members',
    'groups.table.updated': 'Updated',
    'groups.table.type': 'Type',
    'groups.table.actions': 'Actions',
    'groups.table.search': 'Search',
    'groups.table.noGroupsFound': 'No groups found',
    'groups.selectHint': 'Select a group to manage its members and roles.',
    'groups.tabs.overview': 'Overview',
    'groups.tabs.members': 'Members',
    'groups.tabs.roles': 'Roles',
    'groups.tabs.settings': 'Settings',
    'groups.overviewHelp': 'Manage your group. Use tabs to invite members and configure permissions.',
    'groups.invite': 'Invite',
    'groups.optionalUsername': 'optional username',
    'groups.generateLink': 'Generate Link',
    'groups.copy': 'Copy',
    'groups.failedToLoadGroups': 'Failed to load groups. Is backend running on 3000?',
    'groups.nameRequired': 'Group name is required',
    'groups.inviteLinkGenerated': 'Invite link generated',
    'groups.userAddedToGroup': 'User added to group',
    'groups.noMembersYet': 'No members yet',
    'groups.addRole': 'Add Role',
    'groups.role.name': 'Name',
    'groups.role.create': 'Create',
    'groups.role.read': 'Read',
    'groups.role.update': 'Update',
    'groups.role.delete': 'Delete',
    'groups.role.save': 'Save',
    'groups.role.noRolesYet': 'No roles yet',
    'groups.role.noRole': 'No Role',
    'groups.settings.edit': 'Edit Group',
    'groups.settings.placeholder': 'Settings are coming soon',
    'groups.modal.create.title': 'Create Group',
    'groups.modal.edit.title': 'Edit Group',
    'common.create': 'Create',
    'common.close': 'Close',
    'history.title': 'Quiz History',
    'history.searchPlaceholder': 'Search history...',
    'history.summary.attempts': 'Attempts:',
    'history.summary.average': 'Average:',
    'history.summary.passRate': 'Pass rate:',
    'history.empty.noAttempts': 'No attempts yet',
    'history.empty.noHistory': 'No history found',
    'history.empty.tryDifferent': 'Try a different search term.',
    'history.empty.startFromDashboard': 'Start a quiz from the dashboard to track your progress!',
    'history.badge.passed': 'Passed',
    'history.badge.failed': 'Failed',
    'history.score': 'Score',
    'history.review': 'Review',
    'history.unknownDump': 'Unknown Dump',
    'admin.title': 'Admin Dashboard',
    'admin.tabs.analytics': 'Analytics',
    'admin.tabs.users': 'Users',
    'admin.tabs.categories': 'Categories',
    'admin.tabs.dumps': 'Dumps',
    'admin.tabs.groups': 'Groups',
    'admin.tabs.questions': 'Questions',
    'admin.dashboard.platformOverview': 'Platform Overview',
    'admin.dashboard.totalUsers': 'Total Users',
    'admin.dashboard.totalDumps': 'Total Dumps',
    'admin.dashboard.quizzesTaken': 'Quizzes Taken',
    'admin.dashboard.avgScore': 'Avg Score',
    'admin.dashboard.popularDumps': 'Most Popular Dumps',
    'admin.dashboard.dumpsByCategory': 'Dumps by Category',
    'admin.dashboard.quizzesByDate': 'Quizzes by Date (30 days)',
    'admin.common.quizzes': 'Quizzes',
    'admin.popular.dumpName': 'Dump Name',
    'admin.popular.attempts': 'Attempts',
    'admin.common.category': 'Category',
    'admin.common.count': 'Count',
    'admin.common.date': 'Date',
    'admin.users.management': 'User Management',
    'admin.users.searchUsername': 'Search username',
    'admin.common.all': 'All',
    'admin.common.yes': 'Yes',
    'admin.common.no': 'No',
    'admin.table.username': 'Username',
    'admin.table.role': 'Role',
    'admin.table.dumps': 'Dumps',
    'admin.table.quizzes': 'Quizzes',
    'admin.table.avgScore': 'Avg Score',
    'admin.table.joined': 'Joined',
    'admin.table.actions': 'Actions',
    'admin.action.deleteUser': 'Delete User',
    'admin.dumps.all': 'All Dumps',
    'admin.dumps.search': 'Search dumps',
    'admin.dumps.name': 'Name',
    'admin.dumps.category': 'Category',
    'admin.dumps.owner': 'Owner',
    'admin.dumps.questions': 'Questions',
    'admin.dumps.public': 'Public',
    'admin.dumps.created': 'Created',
    'admin.action.edit': 'Edit',
    'admin.action.delete': 'Delete',
    'admin.groups.all': 'All Groups',
    'admin.groups.search': 'Search name or owner',
    'admin.groups.status': 'Status',
    'admin.groups.manage': 'Manage',
    'admin.groups.active': 'Active',
    'admin.groups.inactive': 'Inactive',
    'admin.questions.all': 'All Questions',
    'admin.questions.search': 'Search question or dump',
    'admin.questions.allGroups': 'All Groups',
    'admin.questions.exactMatch': 'Exact match',
    'admin.questions.filter': 'Filter',
    'admin.questions.export': 'Export',
    'admin.questions.question': 'Question',
    'admin.questions.dump': 'Dump',
    'admin.questions.owner': 'Owner',
    'admin.questions.groups': 'Groups',
    'admin.categories.management': 'Category Management',
    'admin.categories.searchPlaceholder': 'Search code, name, description',
    'admin.categories.add': 'Add Category',
    'admin.categories.edit': 'Edit Category',
    'admin.categories.code': 'Code (e.g., CSA)',
    'admin.categories.name': 'Name',
    'admin.categories.description': 'Description (optional)',
    'admin.categories.public': 'Public',
    'admin.categories.groupOptional': 'Group (optional)',
    'admin.categories.group': 'Group',
    'admin.categories.count': '{count} categories',
    'admin.categories.placeholder.code': 'CSA',
    'admin.categories.placeholder.name': 'CSA - Certified System Administrator',
    'admin.categories.placeholder.description': 'ServiceNow System Administrator certification',
    'admin.common.none': 'None',
    'admin.common.cancel': 'Cancel',
    'admin.common.update': 'Update',
    'admin.common.close': 'Close',
    'admin.manageGroup.title': 'Manage Group',
    'admin.manageGroup.status': 'Status:',
    'admin.manageGroup.setInactive': 'Set Inactive',
    'admin.manageGroup.setActive': 'Set Active',
    'admin.manageGroup.member': 'Member',
    'admin.manageGroup.role': 'Role',
    'admin.history.titleForDate': 'Quiz History for {date}'
  },
  vi: {
    'brand.name': 'Dumps Master',
    'nav.dashboard': 'Báº£ng Ä‘iá»u khiá»ƒn',
    'nav.history': 'Lá»‹ch sá»­',
    'nav.groups': 'NhÃ³m',
    'nav.admin': 'Quáº£n trá»‹',
    'nav.profile': 'Há»“ sÆ¡',
    'nav.logout': 'ÄÄƒng xuáº¥t',
    'nav.toggleTheme': 'Äá»•i giao diá»‡n',
    'footer.built': 'XÃ¢y dá»±ng Ä‘á»ƒ há»c táº­p.',

    'auth.login': 'ÄÄƒng nháº­p',
    'auth.signup': 'ÄÄƒng kÃ½',
    'auth.email': 'Email',
    'auth.password': 'Máº­t kháº©u',
    'auth.confirmPassword': 'XÃ¡c nháº­n máº­t kháº©u',
    'auth.togglePrefix.login': 'ChÆ°a cÃ³ tÃ i khoáº£n? ',
    'auth.toggleLink.login': 'ÄÄƒng kÃ½',
    'auth.togglePrefix.signup': 'ÄÃ£ cÃ³ tÃ i khoáº£n? ',
    'auth.toggleLink.signup': 'ÄÄƒng nháº­p',

    'dashboard.loading': 'Äang táº£i Ä‘á» thi...',
    'dashboard.empty': 'KhÃ´ng cÃ³ bá»™ cÃ¢u há»i',
    'hero.badge': 'Ná»n táº£ng luyá»‡n thi',
    'hero.title': 'Trung tÃ¢m luyá»‡n thi cá»§a báº¡n',
    'hero.subtitle': 'Luyá»‡n táº­p vá»›i bá»™ cÃ¢u há»i, táº£i lÃªn cÃ¢u há»i cá»§a báº¡n vÃ  khÃ¡m phÃ¡ thÆ° viá»‡n cÃ´ng khai. Chinh phá»¥c chá»©ng chá»‰ vá»›i bÃ i kiá»ƒm tra tÆ°Æ¡ng tÃ¡c.',
    'tour.title': 'ChÃ o má»«ng Ä‘áº¿n Dumps Master! ðŸŽ“',
    'tour.howto': 'CÃ¡ch sá»­ dá»¥ng á»©ng dá»¥ng:',
    'tour.step1.title': 'Táº£i file máº«u',
    'tour.step1.desc': 'Táº£i file máº«u Ä‘á»ƒ xem Ä‘Ãºng Ä‘á»‹nh dáº¡ng.',
    'tour.step1.cta': 'ðŸ“¥ Táº£i file máº«u',
    'tour.step2.title': 'Chá»‰nh sá»­a bá»™ Ä‘á»',
    'tour.step2.desc': 'Má»Ÿ file CSV báº±ng Excel hoáº·c Google Sheets. ThÃªm cÃ¢u há»i theo Ä‘Ãºng Ä‘á»‹nh dáº¡ng:',
    'tour.step2.listA': 'Cá»™t A: Ná»™i dung cÃ¢u há»i',
    'tour.step2.listB': 'Cá»™t B-E: CÃ¡c lá»±a chá»n (A, B, C, D)',
    'tour.step2.listC': 'Cá»™t F: ÄÃ¡p Ã¡n Ä‘Ãºng (A, B, C hoáº·c D)',
    'tour.step3.title': 'Táº£i lÃªn bá»™ Ä‘á»',
    'tour.step3.desc': 'Nháº¥n nÃºt "ThÃªm má»›i" phÃ­a dÆ°á»›i vÃ  táº£i lÃªn file CSV Ä‘Ã£ chá»‰nh sá»­a. Báº¡n cÃ³ thá»ƒ Ä‘áº·t cÃ´ng khai hoáº·c riÃªng tÆ°.',
    'tour.step4.title': 'Báº¯t Ä‘áº§u luyá»‡n táº­p!',
    'tour.step4.desc': 'Nháº¥n "Xem" trÃªn báº¥t ká»³ bá»™ Ä‘á» nÃ o Ä‘á»ƒ báº¯t Ä‘áº§u lÃ m bÃ i. Báº¡n cÅ©ng cÃ³ thá»ƒ khÃ¡m phÃ¡ thÆ° viá»‡n cÃ´ng khai Ä‘á»ƒ luyá»‡n táº­p tá»« bá»™ Ä‘á» cá»§a ngÆ°á»i khÃ¡c.',
    'tour.close': 'ÄÃ£ hiá»ƒu, báº¯t Ä‘áº§u thÃ´i!',
    'section.available': 'Bá»™ Ä‘á» hiá»‡n cÃ³',
    'tabs.my': 'Bá»™ Ä‘á» cá»§a tÃ´i',
    'tabs.group': 'NhÃ³m',
    'tabs.public': 'CÃ´ng khai',
    'search.placeholder': 'TÃ¬m bá»™ Ä‘á» theo tÃªn...',
    'filter.all': 'Táº¥t cáº£ danh má»¥c',
    'filter.uncategorized': 'ChÆ°a phÃ¢n loáº¡i',
    'button.addNew': 'ThÃªm má»›i',
    'modal.quickUpload.title': 'Táº£i lÃªn nhanh',
    'card.selfPaced': 'Tá»± há»c',
    'card.view': 'Xem',
    'tooltip.edit': 'Sá»­a',
    'tooltip.delete': 'XÃ³a',
    'empty.hint.search': 'HÃ£y Ä‘iá»u chá»‰nh tÃ¬m kiáº¿m hoáº·c bá»™ lá»c Ä‘á»ƒ tÃ¬m ná»™i dung phÃ¹ há»£p.',
    'empty.hint.my': 'Báº¯t Ä‘áº§u báº±ng cÃ¡ch táº£i lÃªn bá»™ Ä‘á» Ä‘áº§u tiÃªn báº±ng nÃºt "ThÃªm má»›i" á»Ÿ trÃªn.',
    'empty.hint.public': 'ChÆ°a cÃ³ bá»™ Ä‘á» cÃ´ng khai. Quay láº¡i sau hoáº·c táº¡o bá»™ Ä‘á» cá»§a riÃªng báº¡n!',
    'empty.createFirst': 'Táº¡o bá»™ Ä‘á» Ä‘áº§u tiÃªn',
    'common.cancel': 'Há»§y',
    'common.saveChanges': 'LÆ°u thay Ä‘á»•i',
    'common.shareToGroups': 'Chia sáº» cho NhÃ³m',
    'common.export': 'Xuáº¥t',
    'common.import': 'Nháº­p',
    'common.name': 'TÃªn',
    'common.description': 'MÃ´ táº£',
    'editor.title': 'Chá»‰nh sá»­a Bá»™ Ä‘á»',
    'editor.questions': 'CÃ¢u há»i',
    'editor.addQuestion': 'ThÃªm cÃ¢u há»i',
    'editor.editQuestion': 'Sá»­a cÃ¢u há»i',
    'editor.correctAnswers': 'ÄÃ¡p Ã¡n Ä‘Ãºng',

    'quiz.previous': 'TrÆ°á»›c',
    'quiz.next': 'Tiáº¿p',
    'quiz.finish': 'HoÃ n thÃ nh',
    'quiz.exit': 'ThoÃ¡t',
    'quiz.reviewAnswers': 'Xem láº¡i Ä‘Ã¡p Ã¡n',
    'quiz.completed': 'HoÃ n thÃ nh bÃ i kiá»ƒm tra!',
    'quiz.scored': 'Báº¡n Ä‘áº¡t {score} trÃªn {total}',
    'quiz.questionCounter': 'CÃ¢u {current} / {total}',
    'quiz.timeLeft': 'Thá»i gian cÃ²n láº¡i',
    'quiz.reviewMode': 'Cháº¿ Ä‘á»™ xem láº¡i',
    'quiz.score': 'Äiá»ƒm',
    'quiz.questions': 'Danh sÃ¡ch cÃ¢u há»i',
    'quiz.total': 'Tá»•ng',
    'quiz.answered': 'ÄÃ£ tráº£ lá»i',
    'quiz.correct': 'ÄÃºng',
    'common.loading': 'Äang táº£i...',
    'common.errorLabel': 'Lá»—i:',
    'actions.goBackHistory': 'Quay láº¡i Lá»‹ch sá»­',
    'actions.goDashboard': 'Vá» Báº£ng Ä‘iá»u khiá»ƒn',
    'actions.goGroups': 'Vá» NhÃ³m',
    'errors.dumpNotFound': 'KhÃ´ng tÃ¬m tháº¥y bá»™ Ä‘á»',
    'errors.failedToLoadDump': 'KhÃ´ng táº£i Ä‘Æ°á»£c bá»™ Ä‘á»',
    'errors.invalidDumpId': 'ID bá»™ Ä‘á» khÃ´ng há»£p lá»‡',
    'errors.loadingReview': 'Äang táº£i bÃ i Ä‘á»ƒ xem láº¡i...',
    'errors.reviewDescription': 'BÃ i báº¡n muá»‘n xem láº¡i cÃ³ thá»ƒ Ä‘Ã£ bá»‹ xÃ³a hoáº·c báº¡n khÃ´ng cÃ³ quyá»n truy cáº­p.',
    'errors.dumpHasNoQuestions': 'Bá»™ Ä‘á» nÃ y khÃ´ng cÃ³ cÃ¢u há»i',
    'errors.loadingSharedQuiz': 'Äang táº£i bÃ i luyá»‡n chia sáº»...',
    'errors.shared.dumpNotFoundOrNotShared': 'KhÃ´ng tÃ¬m tháº¥y hoáº·c chÆ°a chia sáº» bá»™ Ä‘á»',
    'errors.shared.private': 'Bá»™ Ä‘á» nÃ y á»Ÿ cháº¿ Ä‘á»™ riÃªng tÆ°, khÃ´ng thá»ƒ chia sáº»',
    'errors.shared.failedToLoad': 'KhÃ´ng táº£i Ä‘Æ°á»£c bá»™ Ä‘á» chia sáº»',
    'errors.linkInvalidOrDeleted': 'BÃ i luyá»‡n cÃ³ thá»ƒ á»Ÿ cháº¿ Ä‘á»™ riÃªng tÆ°, Ä‘Ã£ xÃ³a hoáº·c liÃªn káº¿t khÃ´ng há»£p lá»‡.',
    'errors.originalDumpMissing': 'KhÃ´ng tÃ¬m tháº¥y bá»™ Ä‘á» gá»‘c (cÃ³ thá»ƒ Ä‘Ã£ bá»‹ xÃ³a).',
    'errors.failedReviewLoad': 'KhÃ´ng táº£i Ä‘Æ°á»£c bá»™ Ä‘á» Ä‘á»ƒ xem láº¡i',
    'errors.quiz.noQuestionsAvailable': 'KhÃ´ng cÃ³ cÃ¢u há»i',
    'errors.quiz.questionNotFound': 'KhÃ´ng tÃ¬m tháº¥y cÃ¢u há»i',
    'errors.failedToLoadDumps': 'KhÃ´ng táº£i Ä‘Æ°á»£c danh sÃ¡ch bá»™ Ä‘á»',
    'invitation.joinedGroup': 'ÄÃ£ tham gia nhÃ³m',
    'invitation.failedAccept': 'KhÃ´ng cháº¥p nháº­n Ä‘Æ°á»£c lá»i má»i',
    'invitation.accepting': 'Äang cháº¥p nháº­n lá»i má»i...',
    'groups.title': 'NhÃ³m',
    'groups.searchPlaceholder': 'TÃ¬m kiáº¿m nhÃ³m',
    'groups.yourGroups': 'NhÃ³m cá»§a báº¡n',
    'groups.create': 'Táº¡o',
    'groups.manage': 'Quáº£n lÃ½',
    'groups.noGroups': 'ChÆ°a cÃ³ nhÃ³m',
    'groups.memberOf': 'ThÃ nh viÃªn cá»§a',
    'groups.noMemberships': 'ChÆ°a tham gia nhÃ³m nÃ o',
    'groups.createGroup': 'Táº¡o NhÃ³m',
    'groups.new': 'Má»›i',
    'groups.all': 'Táº¥t cáº£',
    'groups.table.name': 'TÃªn',
    'groups.table.description': 'MÃ´ táº£',
    'groups.table.owner': 'Chá»§ sá»Ÿ há»¯u',
    'groups.table.members': 'ThÃ nh viÃªn',
    'groups.table.updated': 'Cáº­p nháº­t',
    'groups.table.type': 'Loáº¡i',
    'groups.table.actions': 'Thao tÃ¡c',
    'groups.table.search': 'TÃ¬m kiáº¿m',
    'groups.table.noGroupsFound': 'KhÃ´ng tÃ¬m tháº¥y nhÃ³m',
    'groups.selectHint': 'Chá»n má»™t nhÃ³m Ä‘á»ƒ quáº£n lÃ½ thÃ nh viÃªn vÃ  vai trÃ².',
    'groups.tabs.overview': 'Tá»•ng quan',
    'groups.tabs.members': 'ThÃ nh viÃªn',
    'groups.tabs.roles': 'Vai trÃ²',
    'groups.tabs.settings': 'CÃ i Ä‘áº·t',
    'groups.overviewHelp': 'Quáº£n lÃ½ nhÃ³m cá»§a báº¡n. DÃ¹ng cÃ¡c tab Ä‘á»ƒ má»i thÃ nh viÃªn vÃ  cáº¥u hÃ¬nh quyá»n.',
    'groups.invite': 'Má»i',
    'groups.optionalUsername': 'tÃªn ngÆ°á»i dÃ¹ng (khÃ´ng báº¯t buá»™c)',
    'groups.generateLink': 'Táº¡o liÃªn káº¿t',
    'groups.copy': 'Sao chÃ©p',
    'groups.failedToLoadGroups': 'KhÃ´ng táº£i Ä‘Æ°á»£c danh sÃ¡ch nhÃ³m. Backend cÃ³ cháº¡y trÃªn 3000 khÃ´ng?',
    'groups.nameRequired': 'TÃªn nhÃ³m lÃ  báº¯t buá»™c',
    'groups.inviteLinkGenerated': 'ÄÃ£ táº¡o liÃªn káº¿t má»i',
    'groups.userAddedToGroup': 'ÄÃ£ thÃªm ngÆ°á»i dÃ¹ng vÃ o nhÃ³m',
    'groups.noMembersYet': 'ChÆ°a cÃ³ thÃ nh viÃªn',
    'groups.addRole': 'ThÃªm vai trÃ²',
    'groups.role.name': 'TÃªn',
    'groups.role.create': 'Táº¡o',
    'groups.role.read': 'Xem',
    'groups.role.update': 'Sá»­a',
    'groups.role.delete': 'XÃ³a',
    'groups.role.save': 'LÆ°u',
    'groups.role.noRolesYet': 'ChÆ°a cÃ³ vai trÃ²',
    'groups.role.noRole': 'KhÃ´ng cÃ³ vai trÃ²',
    'groups.settings.edit': 'Sá»­a nhÃ³m',
    'groups.settings.placeholder': 'TÃ­nh nÄƒng cÃ i Ä‘áº·t sáº½ Ä‘Æ°á»£c bá»• sung',
    'groups.modal.create.title': 'Táº¡o NhÃ³m',
    'groups.modal.edit.title': 'Sá»­a NhÃ³m',
    'common.create': 'Táº¡o',
    'common.close': 'ÄÃ³ng',
    'history.title': 'Lá»‹ch sá»­ lÃ m bÃ i',
    'history.searchPlaceholder': 'TÃ¬m lá»‹ch sá»­...',
    'history.summary.attempts': 'Láº§n lÃ m:',
    'history.summary.average': 'Trung bÃ¬nh:',
    'history.summary.passRate': 'Tá»· lá»‡ Ä‘áº­u:',
    'history.empty.noAttempts': 'ChÆ°a cÃ³ lÆ°á»£t lÃ m nÃ o',
    'history.empty.noHistory': 'KhÃ´ng cÃ³ lá»‹ch sá»­',
    'history.empty.tryDifferent': 'HÃ£y thá»­ tá»« khÃ³a khÃ¡c.',
    'history.empty.startFromDashboard': 'Báº¯t Ä‘áº§u má»™t bÃ i kiá»ƒm tra tá»« báº£ng Ä‘iá»u khiá»ƒn Ä‘á»ƒ theo dÃµi tiáº¿n trÃ¬nh!',
    'history.badge.passed': 'Äáº¡t',
    'history.badge.failed': 'ChÆ°a Ä‘áº¡t',
    'history.score': 'Äiá»ƒm',
    'history.review': 'Xem láº¡i',
    'history.unknownDump': 'Bá»™ Ä‘á» khÃ´ng xÃ¡c Ä‘á»‹nh',
    'admin.title': 'Báº£ng Quáº£n trá»‹',
    'admin.tabs.analytics': 'PhÃ¢n tÃ­ch',
    'admin.tabs.users': 'NgÆ°á»i dÃ¹ng',
    'admin.tabs.categories': 'Danh má»¥c',
    'admin.tabs.dumps': 'Bá»™ Ä‘á»',
    'admin.tabs.groups': 'NhÃ³m',
    'admin.tabs.questions': 'CÃ¢u há»i',
    'admin.dashboard.platformOverview': 'Tá»•ng quan ná»n táº£ng',
    'admin.dashboard.totalUsers': 'Tá»•ng ngÆ°á»i dÃ¹ng',
    'admin.dashboard.totalDumps': 'Tá»•ng bá»™ Ä‘á»',
    'admin.dashboard.quizzesTaken': 'Sá»‘ bÃ i Ä‘Ã£ lÃ m',
    'admin.dashboard.avgScore': 'Äiá»ƒm trung bÃ¬nh',
    'admin.dashboard.popularDumps': 'Bá»™ Ä‘á» phá»• biáº¿n',
    'admin.dashboard.dumpsByCategory': 'Bá»™ Ä‘á» theo danh má»¥c',
    'admin.dashboard.quizzesByDate': 'BÃ i lÃ m theo ngÃ y (30 ngÃ y)',
    'admin.common.quizzes': 'BÃ i lÃ m',
    'admin.popular.dumpName': 'TÃªn bá»™ Ä‘á»',
    'admin.popular.attempts': 'Sá»‘ lÆ°á»£t lÃ m',
    'admin.common.category': 'Danh má»¥c',
    'admin.common.count': 'Sá»‘ lÆ°á»£ng',
    'admin.common.date': 'NgÃ y',
    'admin.users.management': 'Quáº£n lÃ½ ngÆ°á»i dÃ¹ng',
    'admin.users.searchUsername': 'TÃ¬m tÃªn ngÆ°á»i dÃ¹ng',
    'admin.common.all': 'Táº¥t cáº£',
    'admin.common.yes': 'CÃ³',
    'admin.common.no': 'KhÃ´ng',
    'admin.table.username': 'TÃªn ngÆ°á»i dÃ¹ng',
    'admin.table.role': 'Vai trÃ²',
    'admin.table.dumps': 'Bá»™ Ä‘á»',
    'admin.table.quizzes': 'BÃ i lÃ m',
    'admin.table.avgScore': 'Äiá»ƒm TB',
    'admin.table.joined': 'Tham gia',
    'admin.table.actions': 'Thao tÃ¡c',
    'admin.action.deleteUser': 'XÃ³a ngÆ°á»i dÃ¹ng',
    'admin.dumps.all': 'Táº¥t cáº£ bá»™ Ä‘á»',
    'admin.dumps.search': 'TÃ¬m bá»™ Ä‘á»',
    'admin.dumps.name': 'TÃªn',
    'admin.dumps.category': 'Danh má»¥c',
    'admin.dumps.owner': 'Chá»§ sá»Ÿ há»¯u',
    'admin.dumps.questions': 'CÃ¢u há»i',
    'admin.dumps.public': 'CÃ´ng khai',
    'admin.dumps.created': 'Táº¡o lÃºc',
    'admin.action.edit': 'Sá»­a',
    'admin.action.delete': 'XÃ³a',
    'admin.groups.all': 'Táº¥t cáº£ nhÃ³m',
    'admin.groups.search': 'TÃ¬m theo tÃªn hoáº·c chá»§ sá»Ÿ há»¯u',
    'admin.groups.status': 'Tráº¡ng thÃ¡i',
    'admin.groups.manage': 'Quáº£n lÃ½',
    'admin.groups.active': 'Äang hoáº¡t Ä‘á»™ng',
    'admin.groups.inactive': 'Ngá»«ng hoáº¡t Ä‘á»™ng',
    'admin.questions.all': 'Táº¥t cáº£ cÃ¢u há»i',
    'admin.questions.search': 'TÃ¬m cÃ¢u há»i hoáº·c bá»™ Ä‘á»',
    'admin.questions.allGroups': 'Táº¥t cáº£ nhÃ³m',
    'admin.questions.exactMatch': 'Khá»›p chÃ­nh xÃ¡c',
    'admin.questions.filter': 'Lá»c',
    'admin.questions.export': 'Xuáº¥t',
    'admin.questions.question': 'CÃ¢u há»i',
    'admin.questions.dump': 'Bá»™ Ä‘á»',
    'admin.questions.owner': 'Chá»§ sá»Ÿ há»¯u',
    'admin.questions.groups': 'NhÃ³m',
    'admin.categories.management': 'Quáº£n lÃ½ danh má»¥c',
    'admin.categories.searchPlaceholder': 'TÃ¬m mÃ£, tÃªn, mÃ´ táº£',
    'admin.categories.add': 'ThÃªm danh má»¥c',
    'admin.categories.edit': 'Sá»­a danh má»¥c',
    'admin.categories.code': 'MÃ£ (vÃ­ dá»¥: CSA)',
    'admin.categories.name': 'TÃªn',
    'admin.categories.description': 'MÃ´ táº£ (khÃ´ng báº¯t buá»™c)',
    'admin.categories.public': 'CÃ´ng khai',
    'admin.categories.groupOptional': 'NhÃ³m (khÃ´ng báº¯t buá»™c)',
    'admin.categories.group': 'NhÃ³m',
    'admin.categories.count': '{count} danh má»¥c',
    'admin.categories.placeholder.code': 'CSA',
    'admin.categories.placeholder.name': 'CSA - Quáº£n trá»‹ há»‡ thá»‘ng',
    'admin.categories.placeholder.description': 'Chá»©ng chá»‰ Quáº£n trá»‹ há»‡ thá»‘ng ServiceNow',
    'admin.common.none': 'KhÃ´ng',
    'admin.common.cancel': 'Há»§y',
    'admin.common.update': 'Cáº­p nháº­t',
    'admin.common.close': 'ÄÃ³ng',
    'admin.manageGroup.title': 'Quáº£n lÃ½ nhÃ³m',
    'admin.manageGroup.status': 'Tráº¡ng thÃ¡i:',
    'admin.manageGroup.setInactive': 'Ngá»«ng hoáº¡t Ä‘á»™ng',
    'admin.manageGroup.setActive': 'KÃ­ch hoáº¡t',
    'admin.manageGroup.member': 'ThÃ nh viÃªn',
    'admin.manageGroup.role': 'Vai trÃ²',
    'admin.history.titleForDate': 'Lá»‹ch sá»­ lÃ m bÃ i ngÃ y {date}'
  }
};

export const I18nProvider = ({ children }) => {
  const [lang, setLang] = useState('vi');

  useEffect(() => {
    const saved = localStorage.getItem('lang');
    if (saved) setLang(saved);
  }, []);

  useEffect(() => {
    localStorage.setItem('lang', lang);
  }, [lang]);

  const t = useMemo(() => {
    return (key, vars = {}) => {
      const str = (DICT[lang] && DICT[lang][key]) || DICT.en[key] || key;
      return str.replace(/\{(\w+)\}/g, (_, k) => (vars[k] !== undefined ? String(vars[k]) : `{${k}}`));
    };
  }, [lang]);

  const value = useMemo(() => ({ t, lang, setLang }), [t, lang]);
  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
};

export const useI18n = () => useContext(I18nContext);
